#!/usr/bin/env python
# -*- coding: utf-8 -*-
# Python script to plot scalar flux
# Generated by the C++ transport code

import numpy as np
import matplotlib.pyplot as plt

# Mesh Coordinates
x = np.array([0.1875, 0.5625, 0.9375, 1.3125, 2.3, 3.9, 5.5, 7.1, 8.025, 8.275, 8.525, 8.775, ])
y = np.array([0.1875, 0.5625, 0.9375, 1.3125, 2.3, 3.9, 5.5, 7.1, 8.025, 8.275, 8.525, 8.775, ])

X, Y = np.meshgrid(x, y)

# Create a figure with a tiled layout
fig, axs = plt.subplots(1, 2, figsize=(12, 6), constrained_layout=True)
axs = axs.flatten()

# --- Data and Plot for Group 1 ---
flux_g1 = np.array([
    [2.82208, 2.80049, 2.79027, 2.79129, 2.80647, 2.85906, 2.87075, 2.84087, 2.85035, 2.87616, 2.89044, 2.89054, ],
    [2.80049, 2.81112, 2.81178, 2.80609, 2.82031, 2.87186, 2.8844, 2.86108, 2.86844, 2.8807, 2.88462, 2.88397, ],
    [2.79027, 2.81178, 2.83177, 2.83001, 2.84566, 2.90572, 2.92035, 2.88955, 2.88557, 2.88732, 2.88804, 2.89483, ],
    [2.79129, 2.80609, 2.83001, 2.84959, 2.88974, 2.9642, 2.97832, 2.93027, 2.902, 2.89406, 2.89598, 2.90221, ],
    [2.80647, 2.82031, 2.84566, 2.88974, 3.00083, 3.08789, 3.09859, 3.04006, 2.95782, 2.93114, 2.91829, 2.91301, ],
    [2.85906, 2.87186, 2.90572, 2.9642, 3.08789, 3.19508, 3.20501, 3.13318, 3.05162, 3.01655, 2.98715, 2.97022, ],
    [2.87075, 2.8844, 2.92035, 2.97832, 3.09859, 3.20501, 3.21669, 3.14242, 3.0582, 3.02603, 3.00282, 2.99079, ],
    [2.84087, 2.86108, 2.88955, 2.93027, 3.04005, 3.13317, 3.14242, 3.07873, 2.99708, 2.97037, 2.95836, 2.95451, ],
    [2.85035, 2.86844, 2.88557, 2.902, 2.95782, 3.05162, 3.0582, 2.99708, 2.97667, 2.96909, 2.95615, 2.95011, ],
    [2.87616, 2.8807, 2.88732, 2.89406, 2.93114, 3.01655, 3.02603, 2.97037, 2.96909, 2.98234, 2.9768, 2.96868, ],
    [2.89044, 2.88462, 2.88804, 2.89598, 2.91829, 2.98715, 3.00282, 2.95836, 2.95615, 2.9768, 2.99036, 2.98928, ],
    [2.89054, 2.88397, 2.89483, 2.90221, 2.91301, 2.97022, 2.99079, 2.95451, 2.95011, 2.96868, 2.98928, 3.00627, ],
])

# Create the plot for this group
im = axs[0].pcolormesh(X, Y, flux_g1.T, shading='nearest')
axs[0].set_title('Group 1')
axs[0].axis('equal')
fig.colorbar(im, ax=axs[0])

# --- Data and Plot for Group 2 ---
flux_g2 = np.array([
    [1.71287, 1.70042, 1.67789, 1.65353, 1.58934, 1.50064, 1.48047, 1.52628, 1.55987, 1.56599, 1.57284, 1.57962, ],
    [1.70042, 1.68659, 1.66394, 1.63809, 1.56826, 1.47621, 1.45632, 1.50416, 1.54012, 1.5489, 1.55852, 1.56457, ],
    [1.67789, 1.66394, 1.63631, 1.60434, 1.52415, 1.42199, 1.40246, 1.45947, 1.50328, 1.51603, 1.5283, 1.53261, ],
    [1.65353, 1.63809, 1.60434, 1.5537, 1.44529, 1.32852, 1.30977, 1.38122, 1.44953, 1.47477, 1.49118, 1.49835, ],
    [1.58934, 1.56826, 1.52415, 1.44529, 1.28093, 1.14999, 1.13176, 1.21725, 1.33254, 1.37812, 1.40405, 1.41622, ],
    [1.50064, 1.47621, 1.42199, 1.32852, 1.14999, 1.00684, 0.988308, 1.08386, 1.20721, 1.2602, 1.29346, 1.30932, ],
    [1.48047, 1.45632, 1.40246, 1.30977, 1.13176, 0.988308, 0.969807, 1.06493, 1.18763, 1.24033, 1.27262, 1.28779, ],
    [1.52628, 1.50416, 1.45947, 1.38122, 1.21725, 1.08386, 1.06493, 1.15148, 1.26547, 1.30976, 1.33499, 1.34672, ],
    [1.55987, 1.54012, 1.50327, 1.44953, 1.33254, 1.20721, 1.18763, 1.26547, 1.33771, 1.36404, 1.38368, 1.39277, ],
    [1.56599, 1.5489, 1.51603, 1.47477, 1.37812, 1.2602, 1.24033, 1.30976, 1.36404, 1.38073, 1.39708, 1.40579, ],
    [1.57284, 1.55852, 1.5283, 1.49118, 1.40405, 1.29346, 1.27262, 1.33499, 1.38368, 1.39708, 1.40946, 1.41883, ],
    [1.57962, 1.56457, 1.53261, 1.49835, 1.41622, 1.30932, 1.28779, 1.34672, 1.39277, 1.40579, 1.41883, 1.42591, ],
])

# Create the plot for this group
im = axs[1].pcolormesh(X, Y, flux_g2.T, shading='nearest')
axs[1].set_title('Group 2')
axs[1].axis('equal')
fig.colorbar(im, ax=axs[1])

# Add a main title and show the plot
fig.suptitle('Scalar Flux Distribution', fontsize=16)
plt.show()
