#!/usr/bin/env python
# -*- coding: utf-8 -*-
# Python script to plot scalar flux
# Generated by the C++ transport code

import numpy as np
import matplotlib.pyplot as plt

# Mesh Coordinates
x = np.array([0.0975, 0.2925, 0.455, 0.585, 0.715, 0.845, 1.0025, 1.1875, 1.3725, 1.5575, 1.715, 1.845, 1.975, 2.105, 2.2625, 2.4475, 2.6325, 2.8175, 2.975, 3.105, 3.235, 3.365, 3.5275, 3.7225, ])
y = np.array([0.0975, 0.2925, 0.455, 0.585, 0.715, 0.845, 1.0025, 1.1875, 1.3725, 1.5575, 1.715, 1.845, 1.975, 2.105, 2.2625, 2.4475, 2.6325, 2.8175, 2.975, 3.105, 3.235, 3.365, 3.5275, 3.7225, ])

X, Y = np.meshgrid(x, y)

# Create a figure with a tiled layout
fig, axs = plt.subplots(1, 2, figsize=(12, 6), constrained_layout=True)
axs = axs.flatten()

# --- Data and Plot for Group 1 ---
flux_g1 = np.array([
    [3.60691, 3.60321, 3.64796, 3.64453, 3.64945, 3.65357, 3.60118, 3.6076, 3.61434, 3.61341, 3.65702, 3.6381, 3.6381, 3.65702, 3.61341, 3.61434, 3.6076, 3.60118, 3.65357, 3.64945, 3.64453, 3.64796, 3.60321, 3.60691, ],
    [3.60321, 3.56651, 3.55481, 3.51194, 3.51578, 3.55769, 3.56248, 3.60168, 3.60771, 3.57642, 3.56407, 3.50862, 3.50862, 3.56407, 3.57642, 3.60771, 3.60168, 3.56248, 3.55769, 3.51578, 3.51194, 3.55481, 3.56651, 3.60321, ],
    [3.64796, 3.55481, 3.33299, 3.27269, 3.27893, 3.33935, 3.557, 3.64935, 3.65691, 3.57117, 3.33714, 3.2672, 3.26721, 3.33714, 3.57117, 3.65691, 3.64935, 3.557, 3.33935, 3.27893, 3.27269, 3.33299, 3.55481, 3.64796, ],
    [3.64453, 3.51194, 3.27269, 3.17218, 3.17425, 3.27941, 3.5117, 3.63849, 3.64767, 3.5214, 3.27902, 3.17287, 3.17287, 3.27902, 3.5214, 3.64767, 3.63849, 3.5117, 3.27941, 3.17425, 3.17218, 3.27269, 3.51194, 3.64453, ],
    [3.64945, 3.51578, 3.27892, 3.17425, 3.17309, 3.27547, 3.50975, 3.63749, 3.64845, 3.52737, 3.28376, 3.17982, 3.17982, 3.28376, 3.52737, 3.64845, 3.63749, 3.50975, 3.27547, 3.17309, 3.17425, 3.27892, 3.51578, 3.64945, ],
    [3.65357, 3.55769, 3.33935, 3.27941, 3.27548, 3.34832, 3.56692, 3.65306, 3.66193, 3.57361, 3.3561, 3.29118, 3.29118, 3.3561, 3.57361, 3.66193, 3.65306, 3.56692, 3.34832, 3.27547, 3.27941, 3.33935, 3.55769, 3.65357, ],
    [3.60118, 3.56248, 3.557, 3.5117, 3.50975, 3.56692, 3.579, 3.61976, 3.63237, 3.59461, 3.58817, 3.54617, 3.54617, 3.58817, 3.59461, 3.63237, 3.61976, 3.579, 3.56692, 3.50975, 3.5117, 3.557, 3.56248, 3.60118, ],
    [3.6076, 3.60168, 3.64935, 3.63849, 3.63749, 3.65306, 3.61976, 3.63878, 3.65473, 3.65484, 3.70146, 3.70283, 3.70283, 3.70146, 3.65485, 3.65473, 3.63878, 3.61976, 3.65306, 3.63749, 3.63849, 3.64935, 3.60168, 3.6076, ],
    [3.61434, 3.60771, 3.65691, 3.64767, 3.64845, 3.66193, 3.63237, 3.65473, 3.67505, 3.68476, 3.73265, 3.73839, 3.73839, 3.73265, 3.68476, 3.67505, 3.65473, 3.63237, 3.66193, 3.64845, 3.64767, 3.65691, 3.60771, 3.61434, ],
    [3.61341, 3.57642, 3.57117, 3.5214, 3.52737, 3.57361, 3.59461, 3.65485, 3.68476, 3.70454, 3.74717, 3.74523, 3.74523, 3.74717, 3.70453, 3.68477, 3.65484, 3.59461, 3.57361, 3.52737, 3.5214, 3.57117, 3.57642, 3.61341, ],
    [3.65702, 3.56407, 3.33714, 3.27902, 3.28376, 3.3561, 3.58817, 3.70146, 3.73265, 3.74717, 3.70057, 3.72296, 3.72296, 3.70056, 3.74717, 3.73265, 3.70146, 3.58817, 3.3561, 3.28376, 3.27902, 3.33714, 3.56407, 3.65702, ],
    [3.6381, 3.50862, 3.26721, 3.17287, 3.17982, 3.29118, 3.54617, 3.70283, 3.73839, 3.74523, 3.72296, 3.73148, 3.73148, 3.72296, 3.74523, 3.73839, 3.70283, 3.54617, 3.29118, 3.17982, 3.17287, 3.26721, 3.50862, 3.6381, ],
    [3.6381, 3.50862, 3.2672, 3.17287, 3.17982, 3.29118, 3.54617, 3.70283, 3.73839, 3.74523, 3.72296, 3.73148, 3.73148, 3.72296, 3.74523, 3.73839, 3.70283, 3.54617, 3.29118, 3.17982, 3.17287, 3.26721, 3.50862, 3.6381, ],
    [3.65702, 3.56407, 3.33714, 3.27902, 3.28376, 3.3561, 3.58817, 3.70146, 3.73265, 3.74717, 3.70057, 3.72296, 3.72296, 3.70056, 3.74717, 3.73265, 3.70146, 3.58817, 3.3561, 3.28376, 3.27902, 3.33714, 3.56407, 3.65702, ],
    [3.61341, 3.57642, 3.57117, 3.5214, 3.52737, 3.57361, 3.59461, 3.65485, 3.68476, 3.70454, 3.74717, 3.74523, 3.74523, 3.74717, 3.70454, 3.68476, 3.65485, 3.59461, 3.57361, 3.52737, 3.5214, 3.57117, 3.57642, 3.61341, ],
    [3.61434, 3.60771, 3.65691, 3.64767, 3.64845, 3.66193, 3.63237, 3.65473, 3.67505, 3.68476, 3.73265, 3.73839, 3.73839, 3.73265, 3.68476, 3.67505, 3.65473, 3.63237, 3.66193, 3.64845, 3.64767, 3.65691, 3.60771, 3.61434, ],
    [3.6076, 3.60168, 3.64935, 3.63849, 3.63749, 3.65306, 3.61976, 3.63878, 3.65473, 3.65485, 3.70146, 3.70283, 3.70283, 3.70146, 3.65485, 3.65473, 3.63878, 3.61976, 3.65306, 3.63749, 3.63849, 3.64935, 3.60168, 3.6076, ],
    [3.60118, 3.56248, 3.557, 3.5117, 3.50975, 3.56692, 3.579, 3.61976, 3.63237, 3.59461, 3.58817, 3.54617, 3.54617, 3.58817, 3.59461, 3.63237, 3.61976, 3.579, 3.56692, 3.50975, 3.5117, 3.557, 3.56248, 3.60118, ],
    [3.65357, 3.55769, 3.33935, 3.27941, 3.27547, 3.34832, 3.56692, 3.65306, 3.66193, 3.57361, 3.3561, 3.29118, 3.29118, 3.3561, 3.57361, 3.66193, 3.65306, 3.56692, 3.34832, 3.27547, 3.27941, 3.33935, 3.55769, 3.65357, ],
    [3.64945, 3.51578, 3.27893, 3.17425, 3.17309, 3.27547, 3.50975, 3.63749, 3.64845, 3.52737, 3.28376, 3.17982, 3.17982, 3.28376, 3.52737, 3.64845, 3.63749, 3.50975, 3.27547, 3.17309, 3.17425, 3.27893, 3.51578, 3.64945, ],
    [3.64453, 3.51194, 3.27269, 3.17218, 3.17425, 3.27941, 3.5117, 3.63849, 3.64767, 3.5214, 3.27902, 3.17287, 3.17287, 3.27902, 3.5214, 3.64767, 3.63849, 3.5117, 3.27941, 3.17425, 3.17218, 3.27269, 3.51194, 3.64453, ],
    [3.64796, 3.55481, 3.33299, 3.27269, 3.27893, 3.33935, 3.557, 3.64935, 3.65691, 3.57117, 3.33714, 3.2672, 3.2672, 3.33714, 3.57117, 3.65691, 3.64935, 3.557, 3.33935, 3.27893, 3.27269, 3.33299, 3.55481, 3.64796, ],
    [3.60321, 3.56651, 3.55481, 3.51194, 3.51578, 3.55769, 3.56248, 3.60168, 3.60771, 3.57642, 3.56407, 3.50862, 3.50862, 3.56407, 3.57642, 3.60771, 3.60168, 3.56248, 3.55769, 3.51578, 3.51194, 3.55481, 3.56651, 3.60321, ],
    [3.60691, 3.60321, 3.64796, 3.64453, 3.64945, 3.65357, 3.60118, 3.6076, 3.61434, 3.61341, 3.65702, 3.6381, 3.6381, 3.65702, 3.61341, 3.61434, 3.6076, 3.60118, 3.65357, 3.64945, 3.64453, 3.64796, 3.60321, 3.60691, ],
])

# Create the plot for this group
im = axs[0].pcolormesh(X, Y, flux_g1.T, shading='gouraud')
axs[0].set_title('Group 1')
axs[0].axis('equal')
fig.colorbar(im, ax=axs[0])

# --- Data and Plot for Group 2 ---
flux_g2 = np.array([
    [0.0465321, 0.0475544, 0.046653, 0.0477158, 0.0471609, 0.0457536, 0.0469416, 0.0453618, 0.0449853, 0.0466007, 0.0462598, 0.0482024, 0.0482024, 0.0462598, 0.0466007, 0.0449853, 0.0453618, 0.0469416, 0.0457536, 0.0471609, 0.0477158, 0.046653, 0.0475544, 0.0465321, ],
    [0.0475544, 0.0494074, 0.051409, 0.0541775, 0.0537533, 0.0507675, 0.0489838, 0.046482, 0.0460725, 0.0484622, 0.0509457, 0.054348, 0.054348, 0.0509457, 0.0484622, 0.0460725, 0.046482, 0.0489839, 0.0507675, 0.0537533, 0.0541775, 0.051409, 0.0494074, 0.0475544, ],
    [0.046653, 0.051409, 0.0630177, 0.0678676, 0.0672151, 0.0621464, 0.0508169, 0.0457784, 0.0451185, 0.0499708, 0.0624578, 0.0676058, 0.0676058, 0.0624578, 0.0499708, 0.0451185, 0.0457784, 0.0508169, 0.0621464, 0.0672151, 0.0678676, 0.0630177, 0.051409, 0.046653, ],
    [0.0477158, 0.0541775, 0.0678676, 0.0740628, 0.0738089, 0.0669129, 0.0534134, 0.0471066, 0.0463462, 0.0528866, 0.0669347, 0.0731357, 0.0731357, 0.0669347, 0.0528866, 0.0463462, 0.0471066, 0.0534134, 0.0669129, 0.0738089, 0.0740628, 0.0678676, 0.0541775, 0.0477158, ],
    [0.0471609, 0.0537533, 0.0672151, 0.0738089, 0.0739583, 0.0671968, 0.053468, 0.0470311, 0.0459467, 0.0519672, 0.0660852, 0.0722182, 0.0722182, 0.0660852, 0.0519672, 0.0459467, 0.0470311, 0.053468, 0.0671968, 0.0739583, 0.0738089, 0.0672151, 0.0537533, 0.0471609, ],
    [0.0457536, 0.0507675, 0.0621464, 0.0669129, 0.0671968, 0.0612536, 0.0495455, 0.0449853, 0.0438786, 0.048331, 0.0597058, 0.0643703, 0.0643703, 0.0597058, 0.048331, 0.0438786, 0.0449853, 0.0495455, 0.0612536, 0.0671968, 0.0669129, 0.0621464, 0.0507675, 0.0457536, ],
    [0.0469416, 0.0489838, 0.0508169, 0.0534134, 0.053468, 0.0495455, 0.0466167, 0.0444393, 0.0430805, 0.0445789, 0.0467168, 0.0492252, 0.0492252, 0.0467169, 0.0445789, 0.0430805, 0.0444393, 0.0466167, 0.0495455, 0.053468, 0.0534134, 0.0508169, 0.0489839, 0.0469416, ],
    [0.0453618, 0.046482, 0.0457784, 0.0471066, 0.0470311, 0.0449853, 0.0444393, 0.0424203, 0.0408026, 0.0403699, 0.0393349, 0.039994, 0.039994, 0.0393349, 0.0403699, 0.0408026, 0.0424203, 0.0444393, 0.0449853, 0.0470311, 0.0471066, 0.0457784, 0.046482, 0.0453618, ],
    [0.0449853, 0.0460725, 0.0451185, 0.0463462, 0.0459467, 0.0438786, 0.0430805, 0.0408026, 0.0390438, 0.0376304, 0.0360454, 0.0361949, 0.0361949, 0.0360454, 0.0376304, 0.0390438, 0.0408026, 0.0430805, 0.0438786, 0.0459467, 0.0463462, 0.0451185, 0.0460725, 0.0449853, ],
    [0.0466007, 0.0484622, 0.0499708, 0.0528866, 0.0519672, 0.048331, 0.0445789, 0.0403699, 0.0376304, 0.0338739, 0.0297938, 0.0280082, 0.0280082, 0.0297938, 0.0338739, 0.0376304, 0.0403699, 0.0445789, 0.048331, 0.0519672, 0.0528866, 0.0499708, 0.0484622, 0.0466007, ],
    [0.0462598, 0.0509457, 0.0624578, 0.0669347, 0.0660852, 0.0597058, 0.0467169, 0.0393349, 0.0360454, 0.0297938, 0.0186823, 0.0133319, 0.0133319, 0.0186823, 0.0297938, 0.0360454, 0.0393349, 0.0467169, 0.0597058, 0.0660852, 0.0669347, 0.0624578, 0.0509457, 0.0462598, ],
    [0.0482024, 0.054348, 0.0676058, 0.0731357, 0.0722182, 0.0643703, 0.0492252, 0.039994, 0.0361949, 0.0280082, 0.0133319, 0.0058892, 0.0058892, 0.0133319, 0.0280082, 0.0361949, 0.039994, 0.0492252, 0.0643703, 0.0722182, 0.0731357, 0.0676058, 0.054348, 0.0482024, ],
    [0.0482024, 0.054348, 0.0676058, 0.0731357, 0.0722182, 0.0643703, 0.0492252, 0.039994, 0.0361949, 0.0280082, 0.0133319, 0.0058892, 0.0058892, 0.0133319, 0.0280082, 0.0361949, 0.039994, 0.0492252, 0.0643703, 0.0722182, 0.0731357, 0.0676058, 0.054348, 0.0482024, ],
    [0.0462598, 0.0509457, 0.0624578, 0.0669347, 0.0660852, 0.0597058, 0.0467169, 0.0393349, 0.0360454, 0.0297938, 0.0186823, 0.0133319, 0.0133319, 0.0186823, 0.0297938, 0.0360454, 0.0393349, 0.0467168, 0.0597058, 0.0660852, 0.0669347, 0.0624578, 0.0509457, 0.0462598, ],
    [0.0466007, 0.0484622, 0.0499708, 0.0528866, 0.0519672, 0.048331, 0.0445789, 0.0403699, 0.0376304, 0.0338739, 0.0297938, 0.0280082, 0.0280082, 0.0297938, 0.0338739, 0.0376304, 0.0403699, 0.0445789, 0.048331, 0.0519672, 0.0528866, 0.0499708, 0.0484622, 0.0466007, ],
    [0.0449853, 0.0460725, 0.0451185, 0.0463462, 0.0459467, 0.0438786, 0.0430805, 0.0408026, 0.0390438, 0.0376304, 0.0360454, 0.0361949, 0.0361949, 0.0360454, 0.0376304, 0.0390438, 0.0408026, 0.0430805, 0.0438786, 0.0459467, 0.0463462, 0.0451185, 0.0460725, 0.0449853, ],
    [0.0453618, 0.046482, 0.0457784, 0.0471066, 0.0470311, 0.0449853, 0.0444393, 0.0424203, 0.0408026, 0.0403699, 0.0393349, 0.039994, 0.039994, 0.0393349, 0.0403699, 0.0408026, 0.0424203, 0.0444393, 0.0449853, 0.0470311, 0.0471066, 0.0457784, 0.046482, 0.0453618, ],
    [0.0469416, 0.0489838, 0.0508169, 0.0534134, 0.053468, 0.0495455, 0.0466167, 0.0444393, 0.0430805, 0.0445789, 0.0467168, 0.0492252, 0.0492252, 0.0467169, 0.0445789, 0.0430805, 0.0444393, 0.0466167, 0.0495455, 0.053468, 0.0534134, 0.0508169, 0.0489839, 0.0469416, ],
    [0.0457536, 0.0507675, 0.0621464, 0.0669129, 0.0671968, 0.0612536, 0.0495455, 0.0449853, 0.0438786, 0.048331, 0.0597058, 0.0643703, 0.0643703, 0.0597058, 0.048331, 0.0438786, 0.0449853, 0.0495455, 0.0612536, 0.0671968, 0.0669129, 0.0621464, 0.0507675, 0.0457536, ],
    [0.0471609, 0.0537533, 0.0672151, 0.0738089, 0.0739583, 0.0671968, 0.053468, 0.0470311, 0.0459467, 0.0519672, 0.0660852, 0.0722182, 0.0722182, 0.0660852, 0.0519672, 0.0459467, 0.0470311, 0.053468, 0.0671968, 0.0739583, 0.0738089, 0.0672151, 0.0537533, 0.0471609, ],
    [0.0477158, 0.0541775, 0.0678676, 0.0740628, 0.0738089, 0.0669129, 0.0534134, 0.0471066, 0.0463462, 0.0528866, 0.0669347, 0.0731357, 0.0731357, 0.0669347, 0.0528866, 0.0463462, 0.0471066, 0.0534134, 0.0669129, 0.0738089, 0.0740628, 0.0678676, 0.0541775, 0.0477158, ],
    [0.046653, 0.051409, 0.0630177, 0.0678676, 0.0672151, 0.0621464, 0.0508169, 0.0457784, 0.0451185, 0.0499708, 0.0624578, 0.0676058, 0.0676058, 0.0624578, 0.0499708, 0.0451185, 0.0457784, 0.0508169, 0.0621464, 0.0672151, 0.0678676, 0.0630177, 0.051409, 0.046653, ],
    [0.0475544, 0.0494074, 0.051409, 0.0541775, 0.0537533, 0.0507675, 0.0489838, 0.046482, 0.0460725, 0.0484622, 0.0509457, 0.054348, 0.054348, 0.0509457, 0.0484622, 0.0460725, 0.046482, 0.0489839, 0.0507675, 0.0537533, 0.0541775, 0.051409, 0.0494074, 0.0475544, ],
    [0.0465321, 0.0475544, 0.046653, 0.0477158, 0.0471609, 0.0457536, 0.0469416, 0.0453618, 0.0449853, 0.0466007, 0.0462598, 0.0482024, 0.0482024, 0.0462598, 0.0466007, 0.0449853, 0.0453618, 0.0469416, 0.0457536, 0.0471609, 0.0477158, 0.046653, 0.0475544, 0.0465321, ],
])

# Create the plot for this group
im = axs[1].pcolormesh(X, Y, flux_g2.T, shading='gouraud')
axs[1].set_title('Group 2')
axs[1].axis('equal')
fig.colorbar(im, ax=axs[1])

# Add a main title and show the plot
fig.suptitle('Scalar Flux Distribution', fontsize=16)
plt.show()
