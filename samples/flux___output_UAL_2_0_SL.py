#!/usr/bin/env python
# -*- coding: utf-8 -*-
# Python script to plot scalar flux
# Generated by the C++ transport code

import numpy as np
import matplotlib.pyplot as plt

# Mesh Coordinates
x = np.array([0.0391539, 0.117462, 0.195769, 0.274077, 0.352385, 0.430693, 0.509, 0.587308, 0.665616, 0.743924, 0.822231, 0.900539, 0.978847, 1.05715, 1.13546, 1.21377, 1.29208, 1.37039, 1.44869, 1.527, 1.60531, 1.68362, 1.76192, 1.84023, 1.91854, 1.99685, 2.07516, 2.15346, 2.23177, 2.31008, 2.38839, 2.46669, 2.545, 2.62331, 2.70162, 2.77993, 2.85823, 2.93654, 3.01485, 3.09316, 3.17146, 3.24977, 3.32808, 3.40639, 3.4847, 3.563, 3.64131, 3.71962, 3.79793, 3.87623, 3.95454, 4.03285, 4.11116, 4.18947, 4.26777, 4.34608, 4.42439, 4.5027, 4.581, 4.65931, 4.73762, 4.81593, 4.89424, 4.97254, 5.05085, 5.12916, 5.20747, 5.28577, 5.36408, 5.44239, 5.5207, 5.599, 5.67731, 5.75562, 5.83393, 5.91224, 5.99054, 6.06885, 6.14716, 6.22547, 6.30377, 6.38208, 6.46039, 6.5387, 6.61701, 6.69531, 6.77362, 6.85193, 6.93024, 7.00854, 7.08685, 7.16516, 7.24347, 7.32178, 7.40008, 7.47839, 7.5567, 7.63501, 7.71331, 7.79162, ])
y = np.array([1.95769, 5.87308, ])

X, Y = np.meshgrid(x, y)

# Create a figure with a tiled layout
fig, axs = plt.subplots(1, 2, figsize=(12, 6), constrained_layout=True)
axs = axs.flatten()

# --- Data and Plot for Group 1 ---
flux_g1 = np.array([
    [4.86953, 4.86956, ],
    [4.86876, 4.86879, ],
    [4.86723, 4.86725, ],
    [4.86492, 4.86495, ],
    [4.86185, 4.86187, ],
    [4.85801, 4.85804, ],
    [4.85341, 4.85343, ],
    [4.84803, 4.84806, ],
    [4.8419, 4.84192, ],
    [4.835, 4.83502, ],
    [4.82733, 4.82736, ],
    [4.81891, 4.81893, ],
    [4.80972, 4.80974, ],
    [4.79977, 4.7998, ],
    [4.78907, 4.78909, ],
    [4.77761, 4.77763, ],
    [4.7654, 4.76542, ],
    [4.75243, 4.75245, ],
    [4.73871, 4.73874, ],
    [4.72425, 4.72427, ],
    [4.70903, 4.70906, ],
    [4.69308, 4.6931, ],
    [4.67638, 4.6764, ],
    [4.65894, 4.65896, ],
    [4.64077, 4.64079, ],
    [4.62186, 4.62188, ],
    [4.60222, 4.60224, ],
    [4.58185, 4.58187, ],
    [4.56076, 4.56078, ],
    [4.53894, 4.53896, ],
    [4.51641, 4.51643, ],
    [4.49316, 4.49318, ],
    [4.4692, 4.46922, ],
    [4.44453, 4.44455, ],
    [4.41916, 4.41918, ],
    [4.39308, 4.3931, ],
    [4.36631, 4.36633, ],
    [4.33885, 4.33887, ],
    [4.3107, 4.31071, ],
    [4.28186, 4.28188, ],
    [4.25234, 4.25236, ],
    [4.22214, 4.22216, ],
    [4.19128, 4.1913, ],
    [4.15975, 4.15976, ],
    [4.12755, 4.12757, ],
    [4.09469, 4.09471, ],
    [4.06119, 4.06121, ],
    [4.02703, 4.02705, ],
    [3.99223, 3.99225, ],
    [3.95679, 3.95681, ],
    [3.92072, 3.92074, ],
    [3.88402, 3.88404, ],
    [3.84669, 3.84671, ],
    [3.80875, 3.80877, ],
    [3.77019, 3.77021, ],
    [3.73103, 3.73104, ],
    [3.69126, 3.69128, ],
    [3.65089, 3.65091, ],
    [3.60993, 3.60994, ],
    [3.56838, 3.56839, ],
    [3.52625, 3.52626, ],
    [3.48353, 3.48355, ],
    [3.44024, 3.44026, ],
    [3.39639, 3.3964, ],
    [3.35196, 3.35197, ],
    [3.30697, 3.30699, ],
    [3.26143, 3.26144, ],
    [3.21532, 3.21534, ],
    [3.16867, 3.16868, ],
    [3.12146, 3.12147, ],
    [3.0737, 3.07371, ],
    [3.02539, 3.02541, ],
    [2.97654, 2.97655, ],
    [2.92713, 2.92714, ],
    [2.87717, 2.87718, ],
    [2.82665, 2.82666, ],
    [2.77557, 2.77558, ],
    [2.72392, 2.72393, ],
    [2.67169, 2.6717, ],
    [2.61888, 2.61889, ],
    [2.56546, 2.56547, ],
    [2.51141, 2.51142, ],
    [2.45673, 2.45674, ],
    [2.40138, 2.40139, ],
    [2.34534, 2.34534, ],
    [2.28856, 2.28856, ],
    [2.23101, 2.23102, ],
    [2.17264, 2.17265, ],
    [2.11339, 2.1134, ],
    [2.0532, 2.05321, ],
    [1.992, 1.99201, ],
    [1.92969, 1.92969, ],
    [1.86617, 1.86618, ],
    [1.80133, 1.80134, ],
    [1.73503, 1.73504, ],
    [1.66712, 1.66713, ],
    [1.59742, 1.59743, ],
    [1.52574, 1.52574, ],
    [1.45184, 1.45184, ],
    [1.37548, 1.37549, ],
])

# Create the plot for this group
im = axs[0].pcolormesh(X, Y, flux_g1.T, shading='gouraud')
axs[0].set_title('Group 1')
axs[0].axis('equal')
fig.colorbar(im, ax=axs[0])

# --- Data and Plot for Group 2 ---
flux_g2 = np.array([
    [1.39908, 1.39911, ],
    [1.39884, 1.39887, ],
    [1.39836, 1.39839, ],
    [1.39765, 1.39768, ],
    [1.39669, 1.39672, ],
    [1.3955, 1.39553, ],
    [1.39407, 1.3941, ],
    [1.3924, 1.39243, ],
    [1.3905, 1.39052, ],
    [1.38835, 1.38838, ],
    [1.38597, 1.386, ],
    [1.38335, 1.38338, ],
    [1.38049, 1.38052, ],
    [1.37739, 1.37742, ],
    [1.37406, 1.37409, ],
    [1.37049, 1.37051, ],
    [1.36668, 1.36671, ],
    [1.36263, 1.36266, ],
    [1.35835, 1.35838, ],
    [1.35383, 1.35386, ],
    [1.34907, 1.3491, ],
    [1.34408, 1.34411, ],
    [1.33885, 1.33888, ],
    [1.33339, 1.33342, ],
    [1.32769, 1.32772, ],
    [1.32175, 1.32178, ],
    [1.31558, 1.31561, ],
    [1.30918, 1.3092, ],
    [1.30253, 1.30256, ],
    [1.29566, 1.29569, ],
    [1.28855, 1.28857, ],
    [1.2812, 1.28123, ],
    [1.27362, 1.27365, ],
    [1.26581, 1.26584, ],
    [1.25776, 1.25779, ],
    [1.24948, 1.24951, ],
    [1.24097, 1.24099, ],
    [1.23222, 1.23224, ],
    [1.22324, 1.22326, ],
    [1.21402, 1.21405, ],
    [1.20457, 1.2046, ],
    [1.19489, 1.19492, ],
    [1.18498, 1.185, ],
    [1.17483, 1.17485, ],
    [1.16445, 1.16447, ],
    [1.15383, 1.15386, ],
    [1.14298, 1.14301, ],
    [1.1319, 1.13192, ],
    [1.12059, 1.12061, ],
    [1.10904, 1.10906, ],
    [1.09725, 1.09727, ],
    [1.08523, 1.08525, ],
    [1.07298, 1.073, ],
    [1.06049, 1.06051, ],
    [1.04776, 1.04778, ],
    [1.0348, 1.03482, ],
    [1.0216, 1.02162, ],
    [1.00817, 1.00819, ],
    [0.994492, 0.99451, ],
    [0.980577, 0.980595, ],
    [0.966421, 0.966439, ],
    [0.952025, 0.952042, ],
    [0.937385, 0.937402, ],
    [0.922502, 0.922519, ],
    [0.907374, 0.90739, ],
    [0.891999, 0.892014, ],
    [0.876375, 0.876391, ],
    [0.860501, 0.860517, ],
    [0.844376, 0.84439, ],
    [0.827996, 0.82801, ],
    [0.811359, 0.811373, ],
    [0.794464, 0.794477, ],
    [0.777307, 0.77732, ],
    [0.759885, 0.759898, ],
    [0.742195, 0.742208, ],
    [0.724234, 0.724246, ],
    [0.705998, 0.70601, ],
    [0.687482, 0.687493, ],
    [0.668682, 0.668693, ],
    [0.649593, 0.649603, ],
    [0.630209, 0.630219, ],
    [0.610523, 0.610533, ],
    [0.59053, 0.590539, ],
    [0.570221, 0.57023, ],
    [0.549586, 0.549595, ],
    [0.528617, 0.528625, ],
    [0.507302, 0.50731, ],
    [0.485626, 0.485634, ],
    [0.463575, 0.463582, ],
    [0.441129, 0.441136, ],
    [0.418264, 0.418271, ],
    [0.394948, 0.394954, ],
    [0.371137, 0.371143, ],
    [0.346765, 0.34677, ],
    [0.321728, 0.321733, ],
    [0.295852, 0.295857, ],
    [0.268831, 0.268835, ],
    [0.240108, 0.240111, ],
    [0.208642, 0.208645, ],
    [0.172461, 0.172463, ],
])

# Create the plot for this group
im = axs[1].pcolormesh(X, Y, flux_g2.T, shading='gouraud')
axs[1].set_title('Group 2')
axs[1].axis('equal')
fig.colorbar(im, ax=axs[1])

# Add a main title and show the plot
fig.suptitle('Scalar Flux Distribution', fontsize=16)
plt.show()
